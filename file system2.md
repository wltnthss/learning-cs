## 파일 시스템

파일 시스템이 파일과 디렉터리를 보조기억장치에 어떻게 할당하고 접근하는지,

FAT파일 시스템과 유닉스 파일 시스템은 무엇인지?

### 파티셔닝과 포매팅

보조기억장치를 파티션을 나누는 작업(파티셔닝)과 포맷 작업(포매팅)을 거쳐야 함.

파티셔닝은 저장 장치의 논리적인 영역을 구획하는 작업임.
(서랍을 정리할 때 칸막이로 구역을 나누는 것과 유사함)

그리고 이렇게 나누어진 영역 하나하나를 파티션이라고 함.

포맷하는 작업, 즉 포매팅은 파일 시스템을 설정하고 어떤 방식으로 파일을 저장하고 관리할 것인지 결정.

어떤 종류의 파일 시스템을 사용할지는 이 때 결정남.

### 파일 할당 방법

하드 디스크의 포매팅까지 끝내고 나면 저장 장치에 파일을 저장하는 경우,

운영체제는 파일과 디렉터리를 블록단위로 읽고 씀

하나의 파일이 보조기억장치에 저장될 때는 하나 이상의 블록에 걸쳐 저장됨.

하드 디스크안에는 여러 블록이 있는데 블록 안에 적힌 번호는 블록의 위치를 식별하는 주소이며

블록에 사용하는 파일을 할당해야함.

이런 상황에서 파일을 보조기억장치에 할당하는 방법에는 연속 할당과 불연속 할당 두 가지가 있음.

### 연속 할당

연속 할당은 보조기억장치 내 연속적인 블록에 파일을 할당하는 방식임.

연속으로 할당된 파일에 접근하기 위해서는 파일의 첫 번째 주소와 블록 단위의 길이를 알아야함.

연속 할당 방식은 파일을 그저 연속적으로 저장하는 방식이기에 구현은 단순하나, 외부 단편화를 야기함.

### 연결 할당

연속 할당의 문제를 해결할 수 있는 방식이 연결 할당 방법임.

연결 할당은 각 블록 일부에 다음 블록의 주소를 저장해서 각 블록이 다음 블록을 가리키는 형태로 할당하는 방식임.

즉, 파일을 이루는 데이터를 연결 리스트로 관리함.

비어있는 임의의 block을 첫 block으로 지정하고 파일이 커지면 다른 block을 할당 받으면서 포인터 연결만 하면 됨.

외부 단편화 문제는 해결될 수 있으나 

첫 번재 블록부터 하나씩 차례대로 읽어야되고, 고장이나 오류 발생 시 접근할 수 없다는 단점이 있음.

### 색인 할당

연결 할당은 블록 일부에 다음 블록 주소를 표현하는 방식임.

반면에 색인 할당은 파일의 모든 블록 주소를 색인 블록이라는 하나의 블록에 모아 관리하는 방식임.

색인 할당은 연결 할당과 달리 파일 내 임의의 위치에 접근하기가 쉬움.

파일의 i번쨰 데이터 블록에 접근하고 싶다면 색인 블록의 i번째 항목이 가리키는 블록에 접근하면 되기 때문임.

색인 한당을 사용하는 파일 시스템에서는 디렉터리 엔트리페 알 이름과 더불어 색인 블록 주소를 명시함.

색인 할당을 기반으로 만든 파일 시스템이 유닉스 파일 시스템임.

### FAT 파일 시스템

연결 할당의 단점을 보완한 파일 시스템이 FAT 파일 시스템임.

연결 할당 방식에는 블록 안에 다음 블록의 주소를 저장한다는 단점이 있었음.

하지만 각 블록에 포함된 다음 블록의 주소들을 한데 모아 테이블 형태로 관리면 단점이 해소가 가능함.

이를 파일 할당 테이블이라고함.

![image](https://github.com/wltnthss/learning-cs/assets/60785586/5e8bc8c6-e8ca-4496-965e-51837bfd6e68)

a.sh 를 읽기 위해서 3번, 15번, 9번 블록을 확인하여 위치를 찾은 뒤 9,8,11,13 번 블록으로 접근함

### 유닉스 파일 시스템

색인 할당 기반의 유닉스 파일 시스템임.

색인 할당은 색인 블록을 기반으로 파일의 데이터 블록들을 찾는 방식인데

유닉스 파일 시스템에서는 이 색인 블록을 i-node라고 부름.

i-node 에는 파일 속성 정보와 열다섯 개의 블록 주소가 저장될 수 있음

이 때 열다섯 개가 넘는 블록이 있는 경우에는 어떻게 되는가??

* 1. 블록 주소 중 열두 개에는 직접 블록 주소를 저장함.

![image](https://github.com/wltnthss/learning-cs/assets/60785586/48be8850-268d-40ce-9a1f-c0d77b6daaf2)

  2. '첫째' 내용으로 충분하지 않다면 열세 번째 주소에 단일 간접 블록 주소를 저장함.
     (데이터의 주소를 저장한 블록의 주소를 저장함.)

![image](https://github.com/wltnthss/learning-cs/assets/60785586/ce4c4503-7c35-4764-89bd-6dbce3f15fa8)

  3. '둘째' 내용으로 충분하지 않다면 열네 번째 주소에 이중 간접 블록 주소를 저장함.
    (단일 간접 블록 주소의 주소를 저장하는 블록의 주소를 저장함.)

![image](https://github.com/wltnthss/learning-cs/assets/60785586/2f077e6f-cfce-4bab-8859-7a07474b1107)

이 처럼 i-node만 알면 파일 속성뿐만 아니라 파일 크기가 크더라도 데이터를 모두 가리킬 수 있음.




 
